# 230323(목) - 리눅스 파일시스템, 패키지 매니저
1. [File system](#file-system) 

2. [Package Manager](#package-manager)
3. [APT](#apt)
- advanced package tools
- sources.list
- mirror site
- apt vs apt-get, apt-cache

---
## File system
### Partition

- disk label
- partition type

**Partition** 

⇒ Physical 혹은 logical 구획 : 과거에는 physical partition만 존재

⇒ 최근에는 logical parition 선호 : 대표적으로 logical Volume(LVM)을 사용하는 방법 물리적 구획을 우선으로 하고 Locgical partition을 사용할 수 있게 함 → 디스크를 묶어서  용량보다 큰 파티션도 만들 수 있음 

**disklabel type**

- DOS / GPT 방식
- DOS partition 종류 :  Primary partition(주) , Extended partition(확장), Logical drive(논리 드라이브)
### fdisk /dev/sda를 이용한 파일 시스템 변경
![image](https://user-images.githubusercontent.com/125112464/227134349-95039298-b9a2-4606-9ce3-5a4a6ee5c2cc.png)

## Package-Manager
```shell
dpkg -s # 패키지 상태확인
     -S # 패키지 검색 : 파일 명 (dpkg -S /bin/ls)
     --audit # 수정
     -l # list 확인
```

## APT

### apt (adv.package tool)

- debian 의 dpkg를 랩핑한 front-end tool → dependency 탐색 및 설치 기능을 좋게한 것이 apt system
- binary : apt-get(install/remove/upgrade) , apt-cache(query)
- binary-extensions : apt-file
- new binary : apt (최신 툴)

### apt (source list)

- 내가 받기 위한 source가 있는 곳을 지정하는 방법
- /etc/apt/sources.list : 를 직접 편집해도 되지만 추가할 경우에 /etc/apt/sources.list.d/에 *.list 파일명으로 추가하는 편이 좋음
- 주로 편집시 apt edit-sources 명령어로 가능
- sources.list format
    
    ```bash
    deb [option1=value1 option2=value2] uri suite [component1] [component2] [...] # debian package를 가져오는 것
    deb-src [option1=value1 option2=value2] uri suite [component1] # debian package안의 source code를 가져오는 것 
    
    ```
    
    - uri : DEB 패키지를 제공하는 사이트의 URI
    - suite : distribution codename 디렉터리 이름 (==dist. version)
    - c[omponent : suite의 구성 요소 및 라이선스 종류별 분류](https://help.ubuntu.com/community/Repositories)
        
        아래 세가지가 가장 유용하게 쓰임
        
        - main : officially supported (ubuntu에서 직접관리하는)
        - restricted :  free license
        - universe : 완전 officially 는 아니지만 절반 정도!
        
        ---
        
        - security
        - updates
        - proposed
        - backports
        - multiverse

### apt : source list : debian : append

- source list에 URL을 추가 하는 방법 → 직접 추가를 하면 좋은 과정은 아니지만 할 수는 있음
- 실제로는 /etc/apt/sources.list.d/kr.list  로 폴더 밑에 만들어서 추가 함
    

### Practice : Ubuntu 18.04

- Kakao mirror 설정방법
    - 편집대상 파일 : /etc/apt/sources.list.d/kakao.list
        - sudo select-editor 로 vim editor로 설정하자
        - sudo apt edit-sources kakao.list
        
        ```bash
        # kakao mirror : ubuntu 18.04 LTS
        deb http://mirror.kakao.com/ubuntu/ bionic main restricted universe
        deb http://mirror.kakao.com/ubuntu/ bionic-updates main restricted universe
        deb http://mirror.kakao.com/ubuntu/ bionic-security main restricted universe
        ```
        
    - vim : normal 에서는 저장 나오기 ZZ / 또는 :x == :wq
    - 앞에꺼 다 막 # 쳐서 카카오 꺼만 쓰면 좀 더 빠르긴 하다고 함
        - Ctrl-V 해서 colum 편집기능으로 한번에 바꿀 수 있으니
        

### apt : list

- apt list [options] [package pattern]
- 패키지 목록 출력
- options :
    
    ```bash
    # apt list
    # apt list --installed # 설치된 패키지 리스트
    # apt list --upgradable # 업그레이드가 가능한 패키지 리스트
    # apt list bash* # 모든 버전의 패키지 리스트
    ```
    

### apt : search

- apt search [-n] <regex>
- 패키지를 키워드로 검색, 키워드는 REGEX로 입력
- options
    
    ```bash
    # apt search bash #name이 아닌 descriotion에 bash가 들어간 경우까지 검색한다.
    # apt search -n bash #name의 중간에 bash가 있어도 검색한다.
    # apt search -n '^bash' #name의 시작부분에 bash가 있는 경우만 검색한다.
    ```
    

### apt : show

- apt show <package name>[=version]
    
    ```bash
    # apt show bash
    # apt list --all-versions bash
    Listing... Done
    bash/bionic-updates,bionic-security,bionic-updates,bionic-security 4.4.18-2ubuntu1.3 amd64 [upgradable from: 4.4.18-2ubuntu1.2]
    bash/now 4.4.18-2ubuntu1.2 amd64 [installed,upgradable to: 4.4.18-2ubuntu1.3]
    bash/bionic,bionic 4.4.18-2ubuntu1 amd64
    
    # apt show [특정버전명지정]
    ```
    

### apt : remove, purge, autoremove

- remove : 패키지만 삭제 (config 파일은 남겨둠)
- purge : 설정이 꼬이거나, 완전삭제 (config 도 삭제)
- autoremove : 의존성이 깨지거나 버전 관리로 인해 쓰이지 않는 패키지를 자동 제거

### apt : install : unmet dependency #1

- univers 를 source.list에서 빼먹었을 경우 깨질 경우도 있음 (version이 다르다)    

### apt : install :unmet dependency #2

- downgrade 하는 법
    
    ```bash
    # apt list --all-versions libcurl3-gnutls # 모든 버전을 다 확인한 다음
    # apt install curl libcurl3-gnutls=7.47.0-1ubuntu2 # 버전 별로 설치하면 됨
    ```

